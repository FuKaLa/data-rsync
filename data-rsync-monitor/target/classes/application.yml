spring:
  application:
    name: data-rsync-monitor
  
  # Nacos 配置
  cloud:
    nacos:
      discovery:
        server-addr: ${spring.cloud.nacos.discovery.server-addr:localhost:8848}
        namespace: ${spring.cloud.nacos.discovery.namespace:public}
      config:
        server-addr: ${spring.cloud.nacos.config.server-addr:localhost:8848}
        namespace: ${spring.cloud.nacos.config.namespace:public}
        file-extension: ${spring.cloud.nacos.config.file-extension:yaml}
        group: ${spring.cloud.nacos.config.group:DEFAULT_GROUP}

# 服务器配置
server:
  port: ${server.port:8085}
  servlet:
    context-path: ${server.servlet.context-path:/}

# 健康检查配置
management:
  endpoints:
    web:
      exposure:
        include: ${management.endpoints.web.exposure.include:health,info,metrics,prometheus}
  metrics:
    tags:
      application: ${spring.application.name}
    distribution:
      percentiles-histogram:
        all:
          enabled: ${management.metrics.distribution.percentiles-histogram.all.enabled:true}
    export:
      prometheus:
        enabled: ${management.metrics.export.prometheus.enabled:true}

# 监控配置
monitor:
  # 告警配置
  alert:
    enabled: ${monitor.alert.enabled:true}
    # 告警级别
    levels:
      - severity: critical
        threshold: 90
        message: 系统关键指标超过阈值
      - severity: warning
        threshold: 70
        message: 系统指标接近阈值
      - severity: info
        threshold: 50
        message: 系统指标正常
    # 告警渠道
    channels:
      email:
        enabled: ${monitor.alert.channels.email.enabled:true}
        from: ${monitor.alert.channels.email.from:alert@data-rsync.com}
        to: ${monitor.alert.channels.email.to:admin@data-rsync.com}
        smtp:
          host: ${monitor.alert.channels.email.smtp.host:smtp.data-rsync.com}
          port: ${monitor.alert.channels.email.smtp.port:25}
          username: ${monitor.alert.channels.email.smtp.username:alert@data-rsync.com}
          password: ${monitor.alert.channels.email.smtp.password:password}
      dingtalk:
        enabled: ${monitor.alert.channels.dingtalk.enabled:false}
        webhook: ${monitor.alert.channels.dingtalk.webhook:https://oapi.dingtalk.com/robot/send?access_token=your_token}
      wechat:
        enabled: ${monitor.alert.channels.wechat.enabled:false}
        webhook: ${monitor.alert.channels.wechat.webhook:https://qyapi.weixin.qq.com/cgi-bin/webhook/send?key=your_key}
  
  # 指标采集配置
  metrics:
    # JVM 指标
    jvm:
      enabled: ${monitor.metrics.jvm.enabled:true}
    # 系统指标
    system:
      enabled: ${monitor.metrics.system.enabled:true}
    # 数据源指标
    datasource:
      enabled: ${monitor.metrics.datasource.enabled:true}
    # 任务指标
    task:
      enabled: ${monitor.metrics.task.enabled:true}
    # Milvus 指标
    milvus:
      enabled: ${monitor.metrics.milvus.enabled:true}

# 日志配置
logging:
  level:
    root: ${logging.level.root:info}
    com.data.rsync.monitor: ${logging.level.com.data.rsync.monitor:debug}
  pattern:
    console: ${logging.pattern.console:"%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"}
    file: ${logging.pattern.file:"%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n"}
  file:
    name: ${logging.file.name:/data/applogs/data-rsync-monitor/data-rsync-monitor.log}
